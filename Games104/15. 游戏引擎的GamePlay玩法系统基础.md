- Event Mechanism
- Script System
- Visual Script
- Character，Control，Camera


### Event Mechanism
作用：
- Abstract the world communication to messages
- Decoupling event sending and handling
实现方式：
- Publish-subscribe Pattern
	- Publisher categorizes published messages (events) into classes
	- Subscriber receive messages (events) that are of interest without knowledge of which publishers
	- 3 Key Components of Publish-subscribe Pattern
		- Event Definition
			- 需要是可以让用户自定义添加事件，通过代码生成和反射实现。也可以是生成脚本或者数据。
			- Event Type
			- Event Argument
		- Callback Registration
			- Time points of registration and execution differs，可能导致触发事件的时候对象不存在了
			- Object Strong Reference
				- 强引用关系，比如说内存依赖
				- Prevent object from de-allocation as long as callback function still registered
			- Object Weak Reference
				- 弱引用关系，比如指定范围内的攻击目标
				- Object could be de-allocated, and will check callback function if valid
		- Event Despatching
			- Send event to appropriate destination
			- Event Dispatch : Immediate![[Pasted image 20230121215047.png]]
				- Deep well of callbacks
				- Blocked by function，中间可能被事件打断，而这个事件可能很费时间，导致卡顿。
				- Difficult for parallelization
			- Event Queue
				- Basic Implementation
					- Store events in queue for handling at an arbitrary future time
				- Event Serializing and Deserializing
					- 利用反射，把事件序列化成二进制
					- To store various types of events![[Pasted image 20230121215535.png]]
				- Event Queue
					- Ring buffer![[Pasted image 20230121220451.png]]
					- Batching![[Pasted image 20230121220431.png]]
				- Problems of Event Queue
					- Timeline not determined by publisher
						- 当把事件进行分类后，事件的执行顺序就被打乱了
						- 事件需要支持在被发布后，什么时机执行，pre tick，tick，post tick
					- One-frame delays
						- 因为插入到队列里面去了，延迟了一帧执行

### Script System
- Early Stage Game Logic Programming
	- Compiled language(mostly C/C++)
		- Compiled to machine code with high performance
		- More easier to use than assembly language
	- Problem of Compiled Languages
		- Game requirements get complex as hardware evolves
			- Need quick iterations of gameplay logic
		- Issues with compiled language
			- Need recompilation with even a little modification
			- Program can easily get crashed with incorrect codes