- Navigation
- Steering
- Crowd Simulation 
- Sensing 
- Classic Decision Making Algorithms

### Navigation
- Navigation Steps
	- Map representation
		- Walkable Area
			- We need to tell AI agents where they can walk – Walkable area
			- 同一个地图对于不同的agent可行走区域可能是不一样的，比如士兵和坦克，飞机
			- Walkable area of players is determined by character motion capabilities
				- Physical Collision
				- Climbing slope/height
				- Jumping distance
			- Simulating movement of AI agents as players costs too much
			- AI agents are still expected to have the same walkable area as players
			- 可行走区域表达形式
				- Waypoint Network
					- Network connecting critical points (waypoints) from the map
					- Waypoint sources: 
						- Designed important locations 
						- Corner points to cover walkable area 
						- Internal points to connect near-by waypoints adding flexibility to navigation
					- Usage of waypoint network is similar to subway system
						- Find the nearest points to get on and off the network
						- Plan the path on the waypoint network
					- Pros:
						- Easy to implement
						- Fast path finding, even for large maps 
					- Cons: 
						- Limited flexibility: must go to the nearest point in the network before navigation 
						- Waypoint selection requires manual intervention
				- Grid 
					- Intuitive discretization of map
					- Uniform subdivision into small regular grid shapes
					- Common grid shapes 
						- Square
						- Triangle 
						- Hexagon
					- Grid property could be modified in runtime to reflect dynamic environmental changes
					- Pros: •
						- Easy to implement 
						- Uniform data structure 
						- Dynamic 
					- Cons: 
						- Accuracy depends on grid resolution
						- Dense grid lowers pathfinding performance，格子很密集的话，效率会低，因为线性的存储方式导致cache miss
						- High memory consumption 
						- Hard to handle 3D map，很难表达层次结构，比如桥
				- Navigation Mesh
					- Solves the problem of representing overlapped walkable areas 
					- Approximates the walkable area of character controller based on physical collision and motion capabilities
					- Lowers network density to boost pathfinding performance
					- Convex Polygon of NavMesh
						- Pathfinding generates a series of polygon (Polygon Corridor) need to walk through
						- Convexity guarantees the final path is limited in the polygon and two adjacent polygons have only one common edge (Portal)（两个凸多边形之间只会有一个公共边）
						- 寻路的时候要穿过一个凸多边形，只会穿过一次，如果是凹多边形，可能会有多次
					- Pros: 
						- Support 3D walkable surface 
						- Accurate （精确）
						- Fast in pathfinding 
						- Flexible for selection of start/destination 
						- Dynamic 
					- Cons: 
						- Complex generation algorithm 
						- Not support 3D space（不能给直升飞机这种agent寻路）
				- Sparse Voxel Octree（八叉树）
					- Represents “flyable” 3D space
					- Similar to spatial partitioning
					- Finest level voxels represents complicated boundary
					- Coarser-level voxels represents uniform regions
					- 存储比较费？
					- 寻路比较麻烦？
	- Path finding
		- Distances in map representations can be abstracted as edge costs in graph![[Pasted image 20230122131030.png]]
		- Pathfinding can be abstracted as shortest path problem in non-directional graph
		- Depth-First Search
			- Expand most recently added
		- Breadth-First Search
			- Expand least recently added
		- Dijkstra Algorithm
		- A Star (A*)
			- implement![[Pasted image 20230122143215.png]]
			- Expand lowest cost in list 
			- Distance is known distance from source + heuristic 
			- Greedy: stops when reaches the goal
			- Cost calculation
				- Cost calculation: 𝑓 𝑛 = 𝑔(𝑛) + ℎ(𝑛) 
				- 𝑔(𝑛): the exact cost of the path from the start to node 𝑛 
				- ℎ(𝑛): the estimated cost from node 𝑛 to the goal
			- Heuristic On Grids
				- For 4 directions of movement, we can use Manhattan distance
				- 𝐷1: cost for moving to the adjacent node
				- ℎ(𝑛) = 𝐷1 ∙ (𝑑𝑥 + 𝑑𝑦)
					- 𝑑𝑥 = |𝑥𝑛 − 𝑥𝑔𝑜𝑎𝑙| , 𝑑𝑦 = |𝑦𝑛 − 𝑦𝑔𝑜𝑎𝑙|
			- Heuristic On NavMesh
				- Multiple choices when evaluating cost on NavMesh 
					- Using polygon centers or vertices usually over-estimate（过高估计） the cost 
					- Using hybrid（混合） method introduces（引入） too many points to check
					- Midpoints of edges – a good balance
				- On a navigation mesh that allows any angle of movement, use a straight line distance 
				- Use midpoint of the edge entering the current node as node cost calculation point 
				- 𝐷: the cost for moving unit distance in any direction
					- ℎ(𝑛) = 𝐷 ∙ 欧拉距离
			- Heuristic
				- ℎ(𝑛) controls A* behavior:
					- With 100% accurate estimates, get shortest paths quickly
					- Too low, continue to get shortest paths, but slow down
					- Too high, exit early without shortest path
				- Balance between pathfinding speed and accuracy
	- Path smoothing
		- Why we need path smoothing •
			- Zigzag, many unnecessary turns （路径很曲折）
		- “String Pulling” – Funnel Algorithm（烟囱算法）
			- The scope of the funnel is the possible scope of the path 
			- Narrow the funnel if necessary to fit the portal
			- Terminate when the goal is in the funnel
			- 图1![[Pasted image 20230122143904.png]]
			- 图2![[Pasted image 20230122143915.png]]
	- NavMesh Generation 
		- Voxelization
			- Sample collision scene by voxelization
		- Region Segmentation
			- Calculate the distance of each voxel to border 
			- Mark border voxels by AgentRadius to avoid clipping
			- Watershed Algorithm
				- Gradually “flood” the “terrain” 
				- Form “watershed” (dividing ridge) when “pools” meet
			- Segment the “neighboring” voxels into regions to provide a good basis for polygon mesh
			- Regions don’t have overlapping voxels in 2D
		- Mesh Generation
			- Generate NavMesh from segmented regions
	- NavMesh Advanced Features
		- Polygon Flag
			- Useful for marking terrain types: plains, mountain, water, etc. 
				- “Paint colors” to add user-defined regions 
				- Polygons generated from user-defined regions have special flag
		- Tile
			- 把世界分块，障碍物移动的话，只更新障碍物所在的块的navmesh
			- Fast for responding to dynamic objects 
			- Avoid rebuilding the entire NavMesh 
			- TileSize – trade-off between pathfinding and dynamic rebuilding performance
		- Off-mesh Link
			- Allow agents to jump or teleport


### Steering
